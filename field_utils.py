from neo4j import GraphDatabase

def get_fields_info(NEO4J_URI, NEO4J_USERNAME, NEO4J_PASSWORD):
    query = """
    CALL db.propertyKeys() YIELD propertyKey
    WITH propertyKey
    LIMIT 100
    CALL {
        WITH propertyKey
        MATCH (n)
        WHERE n[propertyKey] IS NOT NULL
        RETURN propertyKey AS key, collect(DISTINCT n[propertyKey])[..5] AS examples
    }
    RETURN key, examples
    ORDER BY key
    """
    if NEO4J_URI=="bolt://64.226.70.172:7687":
        return [{'key': 'ADR01', 'examples': ['Y', 'N']}, {'key': 'ADR02', 'examples': ['Y']}, {'key': 'ADR03', 'examples': ['N']}, {'key': 'ADR90', 'examples': ['Y']}, {'key': 'ADS01', 'examples': ['Y', 'N']}, {'key': 'ADS02', 'examples': ['Y', 'N']}, {'key': 'ADS03', 'examples': ['N']}, {'key': 'ADS90', 'examples': ['Y', 'N']}, {'key': 'IsUSIM', 'examples': ['Y', 'N']}, {'key': 'TACLAST', 'examples': [35876798, 35824011, 35510210, 35301323, 86838804]}, {'key': 'arround_district', 'examples': ['NGOYO', 'OUENZE', 'TIETIE', 'MOKEKO', 'MONGO POUKOU']}, {'key': 'brand_name', 'examples': ['Tecno Telecom', '-', 'S.H.X Mobile', 'Jibite', 'Aolifeng']}, {'key': 'cell_id', 'examples': [27335, 10915, 20745, 38603, 13516]}, {'key': 'cell_name', 'examples': ['TRA2_U5', 'ZOUL_L6', 'MMBT_L6', 'NGOM_E3', 'NZE2_L7']}, {'key': 'data_rev', 'examples': [168.0, 0.0, 275.0, 3407.0, 5237.0]}, {'key': 'data_rev1', 'examples': [504.0, 0.0, 185.0, 3689.0, 7425.0]}, {'key': 'data_rev2', 'examples': [0.0, 1.0, 640.0, 3410.0, 4785.0]}, {'key': 'data_rev3', 'examples': [0.0, 3123.0, 3500.0, 6862.0, 250.0]}, {'key': 'data_rev_bracket', 'examples': ['3- Next 15', '4- Next 30', '5- Bottom 50', '2- Next 4', '1- Top 1']}, {'key': 'data_rev_rank', 'examples': [0.9153775284885821, 0.6323257499161, 0.7011468377727283, 0.26097098984863804, 0.5430234503087733]}, {'key': 'department_city', 'examples': ['POINTE-NOIRE', 'BRAZZAVILLE', 'SANGHA', 'PLATEAUX', 'BOUENZA']}, {'key': 'device_capability', 'examples': ['4G', 'No', '2G', '3G', '5G']}, {'key': 'digital_rev', 'examples': [0.0]}, {'key': 'digital_rev1', 'examples': [0.0]}, {'key': 'digital_rev2', 'examples': [0.0]}, {'key': 'digital_rev3', 'examples': [0.0]}, {'key': 'digital_volume_mb1', 'examples': [0.0]}, {'key': 'digital_volume_mb2', 'examples': [0.0]}, {'key': 'digital_volume_mb3', 'examples': [0.0]}, {'key': 'district', 'examples': ['TIE-TIE', 'OUENZE', 'TIETIE', 'MOKEKO', 'NGOYO']}, {'key': 'dur_minutes1', 'examples': [26.0, 39.0, 0.0, 56.0, 3.0]}, {'key': 'dur_minutes2', 'examples': [62.0, 43.0, 6.0, 47.0, 0.0]}, {'key': 'dur_minutes3', 'examples': [22.233333333333334, 24.416666666666668, 0.9166666666666666, 20.966666666666665, 0.0]}, {'key': 'first_call_date', 'examples': [20171208, 20230914, 20150321, 20210517, 20201016]}, {'key': 'gender', 'examples': ['M', ' ', 'F']}, {'key': 'geomar', 'examples': [' ', 'OUENZE', 'TIETIE', 'OTHERS', 'NGOYO']}, {'key': 'identity_card', 'examples': ['PN0217MM118FK01', 'BZ0523Q1Y2WY3', 'DUMMY', 'BZ0519NF8H6V8', 'PN0312KC859WW']}, {'key': 'imei', 'examples': ['35876798281154.0', '35824011005417.0', '35510210295224.0', '35301323469413.0', '86838804676779.0']}, {'key': 'is_amn', 'examples': ['N', 'Y', ' ']}, {'key': 'latitude', 'examples': [-4.81553, -4.23706, -4.782783333, 1.426694, -4.24664]}, {'key': 'longitude', 'examples': [11.9239, 15.2788, 11.89000278, 16.184333, 15.28503]}, {'key': 'model_name', 'examples': ['Tecno Telecom CL6K/Tecno Camon 30', '-', 'S.H.X Mobile P6', 'Jibite MK60/SICCOO-MK60', 'Aolifeng D50000']}, {'key': 'msisdn', 'examples': [242064992334, 242065261158, 242064836320, 242067259637, 242066474942]}, {'key': 'nb_sms1', 'examples': [100.0, 1.0, 4.0, 545.0, 1017.0]}, {'key': 'nb_sms2', 'examples': [384.0, 0.0, 2.0, 473.0, 518.0]}, {'key': 'nb_sms3', 'examples': [261.0, 0.0, 243.0, 591.0, 313.0]}, {'key': 'owner', 'examples': [' ', 'Helios', 'MTN', 'Divers', 'AERCO']}, {'key': 'quartier', 'examples': ['PATRA2', 'ZOULOU', 'MARCHE MBOTA', 'NGOMBE', 'MARCHE OUENZE 2']}, {'key': 'reg_com', 'examples': ['PNR KOUILOU', 'BZV POOL', 'NORTH2', 'NORTH1', 'SOUTH']}, {'key': 'region', 'examples': ['POINTE-NOIRE', 'BRAZZAVILLE', 'SANGHA', 'PLATEAUX', 'BOUENZA']}, {'key': 'rev_bracket', 'examples': ['3- Next 15', '5- Bottom 50', '4- Next 30', '2- Next 4', '1- Top 1']}, {'key': 'site_id', 'examples': [2233.0, 1091.0, 2074.0, 3060.0, 1351.0]}, {'key': 'site_name', 'examples': ['PATRA2', 'ZOULOU', 'MARCHE MBOTA', 'NGOMBE', 'MARCHE OUENZE 2']}, {'key': 'sms_rev', 'examples': [129.0, 0.0, 9.0, 85.0, 1300.0]}, {'key': 'sms_rev1', 'examples': [66.0, 0.0, 188.0, 1145.0, 915.0]}, {'key': 'sms_rev2', 'examples': [66.0, 0.0, 26.0, 41.0, 1190.0]}, {'key': 'sms_rev3', 'examples': [255.0, 0.0, 26.0, 1564.0, 304.0]}, {'key': 'sub_service_code', 'examples': ['PREPAID', 'Unknown', 'HYBRID', 'POSTPAID']}, {'key': 'technology', 'examples': ['3G', '4G', '2G', '5G', ' ']}, {'key': 'territory_sales', 'examples': ['TIÉ-TIÉ_TS', 'BZV LITORAL', 'SANGHA_TS', 'LOUANDJILI_TS', 'BZV NORD']}, {'key': 'total_rev', 'examples': [1098.0, 1936.0, 200.0, 6290.0, 3769.0]}, {'key': 'total_rev1', 'examples': [1310.0, 3438.0, 500.0, 4097.0, 4109.0]}, {'key': 'total_rev2', 'examples': [1479.0, 2369.0, 1.0, 5973.0, 3930.0]}, {'key': 'total_rev3', 'examples': [505.0, 0.0, 100.0, 8801.0, 3269.0]}, {'key': 'vas_rev', 'examples': [33.0, 0.0, 103.0, 190.0, 7.0]}, {'key': 'vas_rev1', 'examples': [0.0, 80.0, 240.0, 40.0, 130.0]}, {'key': 'vas_rev2', 'examples': [0.0, 100.0, 220.0, 20.0, 30.0]}, {'key': 'vas_rev3', 'examples': [100.0, 0.0, 130.0, 110.0, 20.0]}, {'key': 'voice_rev', 'examples': [768.0, 1936.0, 200.0, 6015.0, 362.0]}, {'key': 'voice_rev1', 'examples': [740.0, 3438.0, 500.0, 3912.0, 420.0]}, {'key': 'voice_rev2', 'examples': [1413.0, 2369.0, 0.0, 5333.0, 520.0]}, {'key': 'voice_rev3', 'examples': [150.0, 0.0, 100.0, 8801.0, 145.0]}, {'key': 'voice_rev_bracket', 'examples': ['3- Next 15', '5- Bottom 50', '4- Next 30', '2- Next 4', '1- Top 1']}, {'key': 'voice_rev_rank', 'examples': [0.9434984470489656, 0.3639325519057584, 0.8436580173101135, 0.2474039104867481, 0.8501380875937061]}, {'key': 'volume_mb', 'examples': [2582.67, 419.67, 103.0, 313.33, 0.0]}, {'key': 'volume_mb1', 'examples': [2500.0, 69.0, 106.0, 472.0, 0.0]}, {'key': 'volume_mb2', 'examples': [2655.0, 1131.0, 2.0, 268.0, 0.0]}, {'key': 'volume_mb3', 'examples': [2593.0, 59.0, 201.0, 200.0, 0.0]}]

    driver = GraphDatabase.driver(NEO4J_URI, auth=(NEO4J_USERNAME, NEO4J_PASSWORD))

    with driver.session() as session:
        try:
            result = session.run(query)
            return [record.data() for record in result]
        except:
            return None
